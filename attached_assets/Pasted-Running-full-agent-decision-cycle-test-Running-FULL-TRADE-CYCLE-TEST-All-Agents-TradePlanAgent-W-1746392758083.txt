Running full agent decision cycle test
Running FULL TRADE CYCLE TEST (All Agents + TradePlanAgent)
Will save full JSON output of trade cycle
Running full agent decision cycle test
Running TechnicalAnalystAgent...
Using agent-specific LLM config for technical_analyst: grok:grok-2-1212
XAI_API_KEY is available
LLM client initialized with: grok:grok-2-1212
Symbol parameter is a dictionary containing market data
Generated BUY signal for 95685.29 with 65% confidence: Oversold conditions with RSI at 26.1
Decision recorded in performance tracker with ID: BTCUSDT-2025-05-04T20:39:10.470661
BUY decision for BTC/USDT @ 95685.29
Reasoning: Oversold conditions with RSI at 26.1
TechnicalAnalystAgent Result:
Signal: BUY, Confidence: 65
Reasoning: Analysis indicates bullish conditions for BTC/USDT
----------------------------------------
Running SentimentAnalystAgent...
Grok sentiment client initialized successfully
Sentiment Analyst Agent initialized with 2 data sources
Using dynamic temperature (random between 0.6-0.9)
Using symbol from symbol parameter: BTC/USDT
No specific sentiment data provided, analyzing general market sentiment
Using dynamic temperature: 0.63
HTTP Request: POST https://api.x.ai/v1/chat/completions "HTTP/1.1 200 OK"
Generated sentiment reasoning (full): The provided data shows a significant upward trend in the price of BTC/USDT over the last 4-hour intervals, with the current price at 95685.29, which is higher than the opening price of the first interval at 84654.68. The volume has also increased notably in the last few intervals, indicating strong market interest and buying pressure. The price has experienced volatility but has generally moved upwards, suggesting a positive market sentiment. The confidence is high due to the clear trend and increased volume.
SentimentAnalystAgent Result:
Signal: BUY, Confidence: 85
Reasoning: The provided data shows a significant upward trend in the price of BTC/USDT over the last 4-hour int...
----------------------------------------
Running SentimentAggregatorAgent...
Using agent-specific LLM config for sentiment_aggregator: grok:grok-2-1212
XAI_API_KEY is available
LLM client initialized with: grok:grok-2-1212
Sentiment Analyzer initialized with Grok model: grok-2-1212
Retrieved current price for BTC/USDT: 95685.29
Decision recorded in performance tracker with ID: BTCUSDT-2025-05-04T20:39:17.655282
NEUTRAL decision for BTC/USDT @ 95685.29
Reasoning: The sentiment for BTCUSDT is neutral due to mixed signals from social media, a decrease in trading volume, and new institutional interest. Recent news and regulatory developments add complexity but do not strongly sway the sentiment in one direction. The market is currently in a state of equilibrium with potential for shifts based on future developments.
SentimentAggregatorAgent Result:
Signal: NEUTRAL, Confidence: 70
Reasoning: Analysis indicates neutral conditions for BTC/USDT
----------------------------------------
Running LiquidityAnalystAgent...
Using agent-specific LLM config for liquidity_analyst: grok:grok-2-1212
XAI_API_KEY is available
LLM client initialized with: grok:grok-2-1212
Fetching order book data for BTC/USDT
Loaded 150 historical decisions
Decision recorded in performance tracker with ID: BTCUSDT-2025-05-04T20:39:17.754972
BUY decision for BTC/USDT @ 95685.285
Reasoning: Moderate buying pressure with bid/ask ratio of 2.07, strong support detected at 95685.28. Suggested entry: 95780.97 (above support), stop-loss: 95685.27. Top bids: [95685.28: 4.64, 95685.27: 0.00, 95685.26: 0.22], top asks: [95685.29: 2.61, 95685.30: 0.00, 95685.44: 0.00]
LiquidityAnalystAgent Result:
Signal: BUY, Confidence: 70
Reasoning: Analysis indicates bullish conditions for BTC/USDT
----------------------------------------
Running OpenInterestAnalystAgent...
Using agent-specific LLM config for open_interest_analyst: grok:grok-2-1212
XAI_API_KEY is available
LLM client initialized with: grok:grok-2-1212
Using pre-fetched price data with 100 records
Using futures symbol: BTCUSDT (converted from BTC/USDT)
Fetching open interest data for BTCUSDT
Requesting futures open interest for symbol: BTCUSDT
Open interest params: {'symbol': 'BTCUSDT', 'period': '4h', 'limit': 30}
Trying to fetch mainnet historical open interest from /futures/data/openInterestHist
Successfully fetched 30 futures open interest records from mainnet historical open interest
Received 30 open interest records
First record sample: {'symbol': 'BTCUSDT', 'sumOpenInterest': 81975.447, 'sumOpenInterestValue': 7723122154.936551, 'timestamp': 1745971200000}
Processing 30 open interest records
Open interest item 0: {'symbol': 'BTCUSDT', 'sumOpenInterest': 81975.447, 'sumOpenInterestValue': 7723122154.936551, 'timestamp': 1745971200000}
Extracted OI: 81975.447, Timestamp: 1745971200000
Open interest item 1: {'symbol': 'BTCUSDT', 'sumOpenInterest': 81497.124, 'sumOpenInterestValue': 7741216215.6624, 'timestamp': 1745985600000}
Extracted OI: 81497.124, Timestamp: 1745985600000
Successfully parsed 30 open interest values out of 30 records
Loaded 150 historical decisions
Decision recorded in performance tracker with ID: BTCUSDT-2025-05-04T20:39:17.865571
NEUTRAL decision for BTC/USDT @ 95685.29
Reasoning: No significant change in open interest (0.9%) or price (0.7%) indicates market equilibrium. Recent open interest neutral by 0.9% over the last 30 periods while price neutral 0.7%.. Recent OI changes: [0.01%, -0.77%, -0.13%, -0.69%, -0.91%, 1.05%, -0.34%, -0.27%], price changes: [-0.07%, -0.52%, -0.14%, 0.16%, -0.48%, 0.05%, 0.12%, 0.11%]
OpenInterestAnalystAgent Result:
Signal: NEUTRAL, Confidence: 65
Reasoning: Analysis indicates neutral conditions for BTC/USDT
----------------------------------------
Running FundingRateAnalystAgent...
Using agent-specific LLM config for funding_rate_analyst: grok:grok-2-1212
XAI_API_KEY is available
LLM client initialized with: grok:grok-2-1212
Decision recorded in performance tracker with ID: BTCUSDT-2025-05-04T20:39:18.054374
BUY decision for BTC/USDT @ 95685.28
Reasoning: Consistently positive and increasing funding rates (0.0037%) indicate strong long bias building with shorts paying increasing premiums. Recent funding rates: [-0.0094%, -0.0087%, -0.0060%, 0.0032%, -0.0015%, 0.0004%, 0.0032%, 0.0037%]
FundingRateAnalystAgent Result:
Signal: BUY, Confidence: 65
Reasoning: Analysis indicates bullish conditions for BTC/USDT
----------------------------------------
Running DecisionAgent with all analysis results...
2025-05-04 20:39:18,066 - decision_agent - INFO - Using agent weights: {'LiquidityAnalystAgent': 1.0, 'TechnicalAnalystAgent': 1.2, 'SentimentAnalystAgent': 0.8, 'SentimentAggregatorAgent': 0.8, 'FundingRateAnalystAgent': 0.8, 'OpenInterestAnalystAgent': 1.0}
Using agent weights: {'LiquidityAnalystAgent': 1.0, 'TechnicalAnalystAgent': 1.2, 'SentimentAnalystAgent': 0.8, 'SentimentAggregatorAgent': 0.8, 'FundingRateAnalystAgent': 0.8, 'OpenInterestAnalystAgent': 1.0}
Using agent-specific LLM config for decision_agent: grok:grok-2-1212
XAI_API_KEY is available
LLM client initialized with: grok:grok-2-1212
2025-05-04 20:39:18,066 - decision_agent - INFO - Decision Agent initialized with confidence threshold=70, allow_conflict_state=True
Decision Agent initialized with confidence threshold=70, allow_conflict_state=True
2025-05-04 20:39:18,066 - decision_agent - INFO - Making decision for BTC/USDT at 4h interval
Making decision for BTC/USDT at 4h interval
2025-05-04 20:39:18,066 - decision_agent - INFO - Using agent weights: {'LiquidityAnalystAgent': 1.0, 'TechnicalAnalystAgent': 1.2, 'SentimentAnalystAgent': 0.8, 'SentimentAggregatorAgent': 0.8, 'FundingRateAnalystAgent': 0.8, 'OpenInterestAnalystAgent': 1.0}
Using agent weights: {'LiquidityAnalystAgent': 1.0, 'TechnicalAnalystAgent': 1.2, 'SentimentAnalystAgent': 0.8, 'SentimentAggregatorAgent': 0.8, 'FundingRateAnalystAgent': 0.8, 'OpenInterestAnalystAgent': 1.0}
2025-05-04 20:39:18,066 - decision_agent - INFO - Making decision with analyses from: technical_analysis, sentiment_analysis, sentiment_aggregator_analysis, liquidity_analysis, open_interest_analysis, funding_rate_analysis
Making decision with analyses from: technical_analysis, sentiment_analysis, sentiment_aggregator_analysis, liquidity_analysis, open_interest_analysis, funding_rate_analysis
2025-05-04 20:39:18,067 - decision_agent - INFO - Attempting weighted decision from multiple analyses
Attempting weighted decision from multiple analyses
2025-05-04 20:39:18,067 - decision_agent - INFO - TechnicalAnalystAgent: BUY with confidence 65, weight 1.2, weighted score 78.0
TechnicalAnalystAgent: BUY with confidence 65, weight 1.2, weighted score 78.0
2025-05-04 20:39:18,067 - decision_agent - INFO - SentimentAnalystAgent: BUY with confidence 85, weight 0.8, weighted score 68.0
SentimentAnalystAgent: BUY with confidence 85, weight 0.8, weighted score 68.0
2025-05-04 20:39:18,067 - decision_agent - WARNING - No weight configured for sentiment_aggregator_analysis, using default weight of 1.0
No weight configured for sentiment_aggregator_analysis, using default weight of 1.0
2025-05-04 20:39:18,067 - decision_agent - INFO - sentiment_aggregator_analysis: NEUTRAL with confidence 70, weight 1.0, weighted score 70.0
sentiment_aggregator_analysis: NEUTRAL with confidence 70, weight 1.0, weighted score 70.0
2025-05-04 20:39:18,067 - decision_agent - INFO - LiquidityAnalystAgent: BUY with confidence 70, weight 1.0, weighted score 70.0
LiquidityAnalystAgent: BUY with confidence 70, weight 1.0, weighted score 70.0
2025-05-04 20:39:18,067 - decision_agent - INFO - OpenInterestAnalystAgent: NEUTRAL with confidence 65, weight 1.0, weighted score 65.0
OpenInterestAnalystAgent: NEUTRAL with confidence 65, weight 1.0, weighted score 65.0
2025-05-04 20:39:18,067 - decision_agent - INFO - FundingRateAnalystAgent: BUY with confidence 65, weight 0.8, weighted score 52.0
FundingRateAnalystAgent: BUY with confidence 65, weight 0.8, weighted score 52.0
2025-05-04 20:39:18,067 - decision_agent - INFO - Signal breakdown:
Signal breakdown:
2025-05-04 20:39:18,067 - decision_agent - INFO -   BUY: 4 agents (avg 71.2%, weighted score: 268.0)
  BUY: 4 agents (avg 71.2%, weighted score: 268.0)
2025-05-04 20:39:18,067 - decision_agent - INFO -   SELL: 0 agents
  SELL: 0 agents
2025-05-04 20:39:18,067 - decision_agent - INFO -   HOLD: 0 agents
  HOLD: 0 agents
2025-05-04 20:39:18,067 - decision_agent - INFO -   NEUTRAL: 2 agents (avg 67.5%, weighted score: 135.0)
  NEUTRAL: 2 agents (avg 67.5%, weighted score: 135.0)
2025-05-04 20:39:18,067 - decision_agent - INFO - Final signal: BUY, confidence: 100.0%, directional confidence: 100.0%
Final signal: BUY, confidence: 100.0%, directional confidence: 100.0%
2025-05-04 20:39:18,068 - decision_agent - INFO - Contributing agents: TechnicalAnalystAgent, SentimentAnalystAgent, LiquidityAnalystAgent, FundingRateAnalystAgent
Contributing agents: TechnicalAnalystAgent, SentimentAnalystAgent, LiquidityAnalystAgent, FundingRateAnalystAgent
Running TradePlanAgent to generate comprehensive trade plan...
DEBUG: Running TradePlanAgent with trade_cycle=True
DEBUG: TradePlanAgent class found: True
DEBUG: create_trade_plan_agent exists: True
DEBUG: Creating trade plan agent with data_provider
Trade plan agent initialized with risk:reward ratio 1.5
Created enhanced TradePlanAgent with config parameters: ['data_provider']
DEBUG: Created trade_plan_agent successfully: True
TradePlanAgent generating plan for BTC/USDT at 1h interval
Generating trade plan for BUY decision with 71.2% confidence
Generating trade plan for BUY decision
Trade plan generated for BUY BTC/USDT with position size 0.6
‚úÖ Trade Plan Summary ‚Äî UNKNOWN (1h)

- Signal:        BUY (Confidence: 71%)
- Entry:         95685.30
- Stop-Loss:     94728.40 (‚Üì -1.00%)
- Take-Profit:   97120.60 (‚Üë 1.50%)
- R:R Ratio:     1.50
- Portfolio Risk: 1.2%
- Position Size:  0.6000
- Trade Type:     swing
- Tags:          ['swing']
- Valid Until:   2025-05-05T04:39:18.068552

üìä Agent Consensus:
- No agent details available

üìå Fallback Heuristics Used:
  Stop-Loss: Yes - Default 1.0% stop-loss calculation
  Take-Profit: Yes - Risk-reward ratio based take-profit (1.5:1)

‚öôÔ∏è Execution Details:
  Execution Time: 0.0002 seconds
  Plan Version: 1.0.0
  Agent Version: TradePlanAgent v0.2.0

üîç Trade Type: swing
  Classified as swing trade with medium-term horizon (confidence: 71.2%)

üí° Bullish bias developing with analyst consensus. Multi-day swing setup Acceptable 1.5:1 swing opportunity.

--------------------------------------------------
‚úÖ Trade Plan Summary ‚Äî UNKNOWN (1h)

- Signal:        BUY (Confidence: 71%)
- Entry:         95685.30
- Stop-Loss:     94728.40 (‚Üì -1.00%)
- Take-Profit:   97120.60 (‚Üë 1.50%)
- R:R Ratio:     1.50
- Portfolio Risk: 1.2%
- Position Size:  0.6000
- Trade Type:     swing
- Tags:          ['swing']
- Valid Until:   2025-05-05T04:39:18.068552

üìä Agent Consensus:
- No agent details available

üìå Fallback Heuristics Used:
  Stop-Loss: Yes - Default 1.0% stop-loss calculation
  Take-Profit: Yes - Risk-reward ratio based take-profit (1.5:1)

‚öôÔ∏è Execution Details:
  Execution Time: 0.0002 seconds
  Plan Version: 1.0.0
  Agent Version: TradePlanAgent v0.2.0

üîç Trade Type: swing
  Classified as swing trade with medium-term horizon (confidence: 71.2%)

üí° Bullish bias developing with analyst consensus. Multi-day swing setup Acceptable 1.5:1 swing opportunity.

--------------------------------------------------
Trade plan generated successfully
Trade plan log saved to: logs/trade_plan_BTCUSDT_20250504_203918.json
DEBUG: Trade plan available: True
DEBUG: Trade plan keys: ['signal', 'confidence', 'contributing_agents', 'reasoning', 'plan_version', 'agent_version', 'strategy_context', 'normalized_confidence', 'summary_confidence', 'conflict_score', 'entry_price', 'stop_loss', 'take_profit', 'position_size', 'reason_summary', 'valid_until', 'trade_type', 'risk_snapshot', 'fallback_plan', 'tags', 'plan_digest', 'decision_trace', 'performance', 'timestamp', 'execution_time_seconds', 'version']

================================================================================
## Agent Test: All Agents (Full Trade Cycle) ##
Symbol: BTC/USDT, Interval: 4h
Time: 2025-05-04T20:39:10.269256, Elapsed: 7.80s
Mode: Real data, Temperature: 0.0
================================================================================

Analysis Result:
Signal:     UNKNOWN
Confidence: 100.0%
Reasoning:  TechnicalAnalystAgent recommends BUY, SentimentAnalystAgent recommends BUY, LiquidityAnalystAgent recommends BUY, FundingRateAnalystAgent recommends BUY

================================================================================