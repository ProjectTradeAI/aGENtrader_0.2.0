Your task is to enhance the DecisionAgent and supporting logic to better handle real-world agent conflicts, improve signal resolution, and correct confidence misrepresentations.

---

### 🎯 Objectives

✅ 1. Normalize Agent Weights

- Ensure `settings.yaml` includes explicit weight entries for **all agents**:
  - `TechnicalAnalystAgent`
  - `SentimentAnalystAgent`
  - `SentimentAggregatorAgent`
  - `LiquidityAnalystAgent`
  - `OpenInterestAnalystAgent`
  - `FundingRateAnalystAgent`

✅ Log any missing weights during startup and prevent fallback to implicit `1.0`.

---

✅ 2. Add “CONFLICTED” Decision State

- If ≥2 agents issue opposing signals (e.g. one `BUY`, one `SELL`) with confidence ≥ `80`, and no consensus exceeds the configured confidence threshold:
  - Set `final_signal = "CONFLICTED"`
  - Output structured reasoning like:
    ```txt
    Conflicting high-confidence signals: BUY (TA, 78%), SELL (Liquidity, 90%)
    ```

✅ Add `--allow_conflict_state` CLI flag (optional) to allow fallback to HOLD if disabled.

---

✅ 3. Improve Final Confidence Calculation

- Update `DecisionAgent._calculate_confidence()` to:
  - Weight confidence by **agent weight**
  - Avoid averaging all signals blindly (e.g. HOLDs with 50% shouldn’t nullify two BUYs at 90%)

✅ Output:
- `final_signal_confidence` (of the chosen signal)
- `weighted_average_confidence`
- `conflict_score` (optional, how far apart top signals are)

---

✅ 4. Fix “UNKNOWN” Result Logic

- Prevent “UNKNOWN” if:
  - Valid high-confidence signals exist
  - Conflict or HOLD state can be resolved

✅ Add fallback:
```python
if final_signal is None:
    if has_strong_conflict:
        final_signal = "CONFLICTED"
    elif most_common_signal is not strong:
        final_signal = "HOLD"
    else:
        final_signal = most_common_signal
✅ 5. Fix Open Interest “Insufficient Data”

Check OpenInterestAnalystAgent:

Ensure it works with limit = 30 (which already succeeds at API level)

Prevent false-negative if ≥10 data points exist

Log a warning instead of blocking agent analysis

✅ Acceptance Criteria
DecisionAgent logs “CONFLICTED” state clearly when appropriate

All agents use explicitly declared weights

Confidence score reflects signal strength, not average fuzziness

Final decisions are never “UNKNOWN” when valid signals exist

OpenInterestAnalystAgent performs analysis unless data is truly missing